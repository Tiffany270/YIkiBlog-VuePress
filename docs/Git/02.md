# Merge and Rebase

::: tip
git merge -s <策略名字>
:::
![merge](./imgs/01.png)
- 使用` git merge `来做分支合并。
- 将`master`分支合并到`feature`分支上，会新增一个`commit`节点来记录这次合并
- `Git`会有很多合并策略，其中常见的是`Fast-forward`、`Recursive `、`Ours`、`Theirs`、`Octopus`
- 默认`Git`会帮你自动挑选合适的合并策略，如果你需要强制指定，使用`git merge -s <策略名字>`

## three-way-merge
- 二向合并，git不知道怎么合并
![merge](./imgs/04.png)
- 三项合并
```bash
int ll_merge(mmbuffer_t *result_buf,
         const char *path,
         mmfile_t *ancestor, const char *ancestor_label,
         mmfile_t *ours, const char *our_label,
         mmfile_t *theirs, const char *their_label,
         const struct ll_merge_options *opts)
```
![merge](./imgs/05.png)
- 自动帮合并这两个文件为 Print(“hello”)
- 复杂点，出现冲突
![merge](./imgs/06.png)

## Recursive-three-way-merge
- 递归寻找路径最短的唯一共同祖先节点，然后以其为`base`节点进行递归三向合并

## Fast-forward
- `Fast-forward`是Git在合并两个没有分叉的分支时的默认行为
![02](./imgs/02.png)
- 将master分支的指向移动到`最后一个`commit节点上
![03](./imgs/03.png)

## Ours & Theirs
- `git merge -s ours dev`

## Octopus
- `git merge`两个以上分支时的默认行为
- 用一个合并节点将两个以上的`commit`全部合并进来

## git rebase
::: tip
git-rebase: Forward-port local commits to the updated upstream head  
        — git doc
:::
- 其与`git merge`的最大区别是，他会更改变更历史对应的`commit`节点。
![gitrebase](./imgs/gitrebase.png)
